[
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Beneficiary Profiling",
  "enabled": 1,
  "modified": "2024-11-12 22:16:09.658249",
  "module": null,
  "name": "Unique House Hold for Beneficiary",
  "script": "frappe.ui.form.on('Beneficiary Profiling', {\n    refresh(frm) {\n        // your code here\n    },\n    before_save: async function (frm) {\n        if (!frm.doc.contact_number && frm.doc.custom_are_you_the_head_of_the_household_ == \"Yes\") {\n            let maxHouseholdId = await frappe.call({\n                method: 'get_max_household_id',\n            });\n            \n\n            let newHouseholdId = (maxHouseholdId.message || 0) + 1;\n            frm.set_value('contact_number', newHouseholdId);\n        }\n    }\n});\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Beneficiary Profiling",
  "enabled": 1,
  "modified": "2024-11-12 22:16:49.651120",
  "module": null,
  "name": "Add family member data fetch from parents",
  "script": "const get_document = async (filter, fields) => {\n    return await frappe.call({\n      method: 'frappe.client.get_value',\n      args: {\n        'doctype': 'Beneficiary Profiling',\n        'filters': filter,\n        'fieldname': fields\n      },\n      callback: function (response) {\n        // Handle the response\n        if (!response.exc) {\n          var doc = response.message;\n          return doc;\n        } else {\n          console.error('Error fetching document:', response.exc);\n        }\n      }\n    });\n}\n\nfrappe.ui.form.on('Beneficiary Profiling', {\n\trefresh(frm) {\n\t    frm.set_df_property('id_table_list','cannot_add_rows',true)\n\t    frm.set_df_property('id_table_list','cannot_delete_rows',true)\n\t    if(frm.doc.select_primary_member && frm.is_new()){\n\t        frm.doc.has_anyone_from_your_family_visisted_before = \"Yes\";\n\t        frm.refresh_fields(['has_anyone_from_your_family_visisted_before','select_primary_member'])\n\t    }\n\t},\n\tafter_save(frm){\n\t   // if(frm.doc.custom_are_you_the_head_of_the_household_ == \"Yes\" && !frm.doc.select_primary_member){\n\t   //     frappe.set_route('Form', 'Primary Member', frm.doc.contact_number);\n\t   // }\n\t},\n\tselect_primary_member: async function (frm) {\n        const pm = frm.doc.select_primary_member;\n        if (pm && !frm.doc.religion && !frm.doc.caste_category ) {\n          let response = await get_document({ \"contact_number\": pm },\n            ['name', \"name_of_the_beneficiary\", 'current_house_type', 'custom_type_of_house' , 'custom_does_your_house_fall_under_ghmc_limit',\n               'custom_mention_the_type_of_roof_','custom_mention_the_type_of_roof_', 'custom_appropriate_municiaplity_municipal_corporation','state', 'district', 'ward',\n              'name_of_the_settlement', 'address_with_landmark', 'same_as_above', 'state_of_origin', 'district_of_origin', 'block',\n              'religion','caste_category','contact_number' , \"custom_when_did_you_migrate\" , \"custom_do_you_have_land_ownership_title_for_the_house\"\n              ]);\n          const parent = response.message;\n          frm.set_value('custom_are_you_the_head_of_the_household_', 'No')\n          frm.doc.religion = parent.religion;\n          frm.doc.caste_category = parent.caste_category;\n          frm.doc.contact_number?null:frm.set_value('contact_number',parent.contact_number);\n          frm.doc.current_house_type = parent.current_house_type;\n          frm.doc.custom_type_of_house = parent.custom_type_of_house;\n          frm.doc.custom_does_your_house_fall_under_ghmc_limit = parent.custom_does_your_house_fall_under_ghmc_limit;\n          frm.doc.custom_mention_the_type_of_roof_ = parent.custom_mention_the_type_of_roof_;\n          frm.doc.custom_when_did_you_migrate = parent.custom_when_did_you_migrate;\n          frm.doc.custom_do_you_have_land_ownership_title_for_the_house = parent.custom_do_you_have_land_ownership_title_for_the_house;\n          frm.doc.custom_appropriate_municiaplity_municipal_corporation = parent.custom_appropriate_municiaplity_municipal_corporation;\n          frm.doc.state = parent.state;\n          frm.doc.district = parent.district;\n          frm.doc.ward = parent.ward;\n          frm.doc.name_of_the_settlement = parent.name_of_the_settlement;\n          frm.doc.address_with_landmark = parent.address_with_landmark;\n          frm.doc.same_as_above = parent.same_as_above;\n          frm.doc.state_of_origin = parent.state_of_origin;\n          frm.doc.district_of_origin = parent.district_of_origin;\n          frm.doc.block = parent.block;\n          frm.refresh_fields(['current_house_type', 'state', 'district', 'ward',\n            'name_of_the_settlement', 'address_with_landmark', 'same_as_above', 'state_of_origin', 'district_of_origin', 'block',\n            'religion','caste_category', 'custom_type_of_house', \"custom_does_your_house_fall_under_ghmc_limit\", \"custom_mention_the_type_of_roof_\",\n            \"custom_appropriate_municiaplity_municipal_corporation\", \"custom_when_did_you_migrate\", 'custom_do_you_have_land_ownership_title_for_the_house'])\n        }\n  },\n    custom_are_you_the_head_of_the_household_: async function(frm){\n            if(frm.doc.custom_are_you_the_head_of_the_household_ == \"Yes\"){\n                frm.set_value('has_anyone_from_your_family_visisted_before', 'No');\n                frm.set_value({\n                    caste_category :'',\n                    religion :'',\n                    custom_type_of_house:'',\n                    custom_does_your_house_fall_under_ghmc_limit :'',\n                    custom_appropriate_municiaplity_municipal_corporation :'',\n                    custom_when_did_you_migrate:'',\n                    custom_do_you_have_land_ownership_title_for_the_house:''\n                })\n            }else{\n                frm.set_value('has_anyone_from_your_family_visisted_before', 'Yes')\n            }\n        },\n\n    \n})\n\nfrappe.ui.form.on('ID Document Child', {\n    form_render(frm, cdt, cdn){\n        frm.fields_dict.id_table_list.grid.wrapper.find('.grid-move-row').hide();\n        let {idx} = frappe.get_doc(cdt,cdn)\n        if((idx > 7)){\n            frm.cur_grid.open_next = () => {\n                return\n            }\n        }\n    },\n});\n\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Primary Member",
  "enabled": 1,
  "modified": "2024-11-12 22:17:35.508353",
  "module": null,
  "name": "add family button in house hold",
  "script": "frappe.ui.form.on('Primary Member', {\n\trefresh(frm) {\n\t\t// your code here\n\t\tif(!frm.is_new()){\n\t\t          frm.add_custom_button(__('Add family members'), function () {\n                    frappe.route_options = {\n                    has_anyone_from_your_family_visisted_before: \"Yes\",\n                    custom_are_you_the_head_of_the_household_ : \"No\",\n                    select_primary_member: frm.doc.name\n        };\n        // Open a new form for the desired DocType\n        frappe.new_doc('Beneficiary Profiling');\n      }, __());\n\t\t}\n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Beneficiary Profiling",
  "enabled": 1,
  "modified": "2024-11-12 22:18:14.134118",
  "module": null,
  "name": "Contact no validation",
  "script": "frappe.ui.form.on('Beneficiary Profiling', {\n\trefresh(frm) {\n\t\t// your code here\n\t},\n\tbefore_save: async function (frm) {\n\t   const indianPhoneNumberRegex = /^(?:(?:(?:\\+|0{0,2})91(\\s*[\\-]\\s*)?|[0]?)?[6789]\\d{9})$/;\n\t   if(frm.doc.custom_custon_contact_number){\n    \tif (!indianPhoneNumberRegex.test(frm.doc.custom_custon_contact_number)) {\n            frappe.throw(`Phone Number <b>${frm.doc.custom_custon_contact_number}</b> set in field Contact number is not valid.`)\n          }\n\t   }\n\t},\n\tcustom_custon_contact_number(frm){\n\n\n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Beneficiary Profiling",
  "enabled": 1,
  "modified": "2024-12-18 10:31:35.874555",
  "module": null,
  "name": "Basline to scheme",
  "script": "frappe.ui.form.on('Beneficiary Profiling', {\n    after_save: async function (frm) {\n    if (!frm.is_new()) {\n          frm.debounced_reload_doc()\n        }\n    },\n    before_save: function(frm) {\n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_do_you_have_any_insured_policies)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Aadhaar Card\",\n                        scheme: \"Aadhaar Card\",\n                        milestone: \"Citizenship Entitlement\",\n                        milestone_category: \"Citizenship Entitlement\",\n                        application_submitted: \"No\",\n                        status:\"Open\"\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Aadhaar Card\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_do_you_have_any_insured_policies)){\n                    let row = {\n                                name: \"\",\n                                docstatus: '',\n                                name_of_the_scheme: \"Voter Card\",\n                                scheme: \"Voter Card\",\n                                milestone: \"Citizenship Entitlement\",\n                                milestone_category: \"Citizenship Entitlement\",\n                                application_submitted: frm.doc.custom_do_you_have_any_insured_policies === \"Under process\" ? \"Yes\" : \"No\",\n                                status: frm.doc.custom_do_you_have_any_insured_policies === \"Under process\" ? \"Under process\" : \"Open\"\n                             };\n                    if (frm.doc.custom_do_you_have_any_insured_policies === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Voter Card\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_do_you_have_pan_card)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Pan Card\",\n                        scheme: \"Pan Card\",\n                        milestone: \"Citizenship Entitlement\",\n                        milestone_category: \"Citizenship Entitlement\",\n                        application_submitted: frm.doc.custom_do_you_have_pan_card === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_do_you_have_pan_card === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_do_you_have_pan_card === \"Under process\") {\n                            row.date_of_application = frappe.datetime.get_today();\n                            row.mode_of_application = \"Offline\";\n                        }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Pan Card\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_do_you_have_income_certificate)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Income Certificate\",\n                        scheme: \"Income Certificate\",\n                        milestone: \"Financial Documents\",\n                        milestone_category: \"Financial Documents\",\n                        application_submitted: frm.doc.custom_do_you_have_income_certificate === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_do_you_have_income_certificate === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_do_you_have_income_certificate === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Income Certificate\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_do_you_have_birth_certificate)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Birth Certificate\",\n                        scheme: \"Birth Certificate\",\n                        milestone: \"Citizenship Entitlement\",\n                        milestone_category: \"Citizenship Entitlement\",\n                        application_submitted: frm.doc.custom_do_you_have_birth_certificate === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_do_you_have_birth_certificate === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_do_you_have_birth_certificate === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Birth Certificate\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n      \n                if([\"Yes\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_4g_do_you_have_death_certificate)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Death Certificate\",\n                        scheme: \"Death Certificate\",\n                        milestone: \"Citizenship Entitlement\",\n                        milestone_category: \"Citizenship Entitlement\",\n                        application_submitted: frm.doc.custom_4g_do_you_have_death_certificate === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_4g_do_you_have_death_certificate === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_4g_do_you_have_death_certificate === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Death Certificate\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_do_you_have_caste_certificate)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Caste Certificate\",\n                        scheme: \"Caste Certificate\",\n                        milestone: \"Citizenship Entitlement\",\n                        milestone_category: \"Citizenship Entitlement\",\n                        application_submitted: frm.doc.custom_do_you_have_caste_certificate === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_do_you_have_caste_certificate === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_do_you_have_caste_certificate === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Caste Certificate\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_do_you_have_residential_certificate)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Residential certificate\",\n                        scheme: \"Residential certificate\",\n                        milestone: \"Citizenship Entitlement\",\n                        milestone_category: \"Citizenship Entitlement\",\n                        application_submitted: frm.doc.custom_do_you_have_residential_certificate === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_do_you_have_residential_certificate === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_do_you_have_residential_certificate === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Residential certificate\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_do_you_have_marriage_certificate)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Marriage certificate\",\n                        scheme: \"Marriage certificate\",\n                        milestone: \"Citizenship Entitlement\",\n                        milestone_category: \"Citizenship Entitlement\",\n                        application_submitted: frm.doc.custom_do_you_have_marriage_certificate === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_do_you_have_marriage_certificate === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_do_you_have_marriage_certificate === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Marriage certificate\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n      \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_do_you_have_driving_license)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Driving Licence (DL)\",\n                        scheme: \"Driving Licence (DL)\",\n                        milestone: \"License\",\n                        milestone_category: \"License\",\n                        application_submitted: frm.doc.custom_do_you_have_driving_license === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_do_you_have_driving_license === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_do_you_have_driving_license === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Driving Licence (DL)\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_do_you_have_passport)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Passport\",\n                        scheme: \"Passport\",\n                        milestone: \"Citizenship Entitlement\",\n                        milestone_category: \"Citizenship Entitlement\",\n                        application_submitted: frm.doc.custom_do_you_have_passport === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_do_you_have_passport === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_do_you_have_passport === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Passport\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_is_your_name__included_in_the_food_security_card)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"New Ration Card\",\n                        scheme: \"New Ration Card\",\n                        milestone: \"Food Security\",\n                        milestone_category: \"Food Security\",\n                        application_submitted: frm.doc.custom_is_your_name__included_in_the_food_security_card === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_is_your_name__included_in_the_food_security_card === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_is_your_name__included_in_the_food_security_card === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"New Ration Card\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_do_you_have_sadrem_disability_certificate_telangana)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"SADREM disability certificate\",\n                        scheme: \"SADREM disability certificate\",\n                        milestone: \"PWD Documents\",\n                        milestone_category: \"PWD Documents\",\n                        application_submitted: frm.doc.custom_do_you_have_sadrem_disability_certificate_telangana === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_do_you_have_sadrem_disability_certificate_telangana === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_do_you_have_sadrem_disability_certificate_telangana === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"SADREM disability certificate\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_do_you_have_labour_card)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Labour Welfare Card\",\n                        scheme: \"Labour Welfare Card\",\n                        milestone: \"License\",\n                        milestone_category: \"License\",\n                        application_submitted: frm.doc.custom_do_you_have_labour_card === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_do_you_have_labour_card === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_do_you_have_labour_card === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Labour Welfare Card\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_do_you_have__obc_certificate)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"OBC certificate\",\n                        scheme: \"OBC certificate\",\n                        milestone: \"Citizenship Entitlement\",\n                        milestone_category: \"Citizenship Entitlement\",\n                        application_submitted: frm.doc.custom_do_you_have__obc_certificate === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_do_you_have__obc_certificate === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_do_you_have__obc_certificate === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"OBC certificate\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_are_you_availing_pradhan_mantri_jeevan_jyoti_bima_yojana)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Pradhan Mantri Jeevan Jyoti Bima Yojana (PMJJBY)\",\n                        scheme: \"Pradhan Mantri Jeevan Jyoti Bima Yojana (PMJJBY)\",\n                        milestone: \"Insurance\",\n                        milestone_category: \"Insurance\",\n                        application_submitted: frm.doc.custom_are_you_availing_pradhan_mantri_jeevan_jyoti_bima_yojana === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_are_you_availing_pradhan_mantri_jeevan_jyoti_bima_yojana === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_are_you_availing_pradhan_mantri_jeevan_jyoti_bima_yojana === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Pradhan Mantri Jeevan Jyoti Bima Yojana (PMJJBY)\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_are_you_availing_pradhan_mantri_suraksha_bima_yojana)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Pradhan Mantri Suraksha Bima Yojana (PMSBY)\",\n                        scheme: \"Pradhan Mantri Suraksha Bima Yojana (PMSBY)\",\n                        milestone: \"Insurance\",\n                        milestone_category: \"Insurance\",\n                        application_submitted: frm.doc.custom_are_you_availing_pradhan_mantri_suraksha_bima_yojana === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_are_you_availing_pradhan_mantri_suraksha_bima_yojana === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_are_you_availing_pradhan_mantri_suraksha_bima_yojana === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Pradhan Mantri Suraksha Bima Yojana (PMSBY)\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_4x_do_you_have_atal_pension_yojana)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Atal Pension Yojana (APY)\",\n                        scheme: \"Atal Pension Yojana (APY)\",\n                        milestone: \"Pension\",\n                        milestone_category: \"Pension\",\n                        application_submitted: frm.doc.custom_4x_do_you_have_atal_pension_yojana === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_4x_do_you_have_atal_pension_yojana === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_4x_do_you_have_atal_pension_yojana === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Atal Pension Yojana (APY)\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_are_you_planning_to_avail_nmms)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"National Means cum Merit Scholarship support (NMMS)\",\n                        scheme: \"National Means cum Merit Scholarship support (NMMS)\",\n                        milestone: \"Education\",\n                        milestone_category: \"Education\",\n                        application_submitted: frm.doc.custom_are_you_planning_to_avail_nmms === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_are_you_planning_to_avail_nmms === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_are_you_planning_to_avail_nmms === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"National Means cum Merit Scholarship support (NMMS)\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_are_you_availing_central_scholarship)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Central scholarship  for College/University Student\",\n                        scheme: \"Central scholarship  for College/University Student\",\n                        milestone: \"Education\",\n                        milestone_category: \"Education\",\n                        application_submitted: frm.doc.custom_are_you_availing_central_scholarship === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_are_you_availing_central_scholarship === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_are_you_availing_central_scholarship === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Central scholarship  for College/University Student\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_are_you_availing_telanagana_pre_metric_scholarship)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Telanagana Pre metric scholarship\",\n                        scheme: \"Telanagana Pre metric scholarship\",\n                        milestone: \"Education\",\n                        milestone_category: \"Education\",\n                        application_submitted: frm.doc.custom_are_you_availing_telanagana_pre_metric_scholarship === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_are_you_availing_telanagana_pre_metric_scholarship === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_are_you_availing_telanagana_pre_metric_scholarship === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Telanagana Pre metric scholarship\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_are_you_availing_telanagana_post_metric_scholarship)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Post Matric Scholarship\",\n                        scheme: \"Post Matric Scholarship\",\n                        milestone: \"Education\",\n                        milestone_category: \"Education\",\n                        application_submitted: frm.doc.custom_are_you_availing_telanagana_post_metric_scholarship === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_are_you_availing_telanagana_post_metric_scholarship === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_are_you_availing_telanagana_post_metric_scholarship === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Post Matric Scholarship\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_are_you_availing_telanagana_disability_pension)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Telanagana disability pension\",\n                        scheme: \"Telanagana disability pension\",\n                        milestone: \"Pension\",\n                        milestone_category: \"Pension\",\n                        application_submitted: frm.doc.custom_are_you_availing_telanagana_disability_pension === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_are_you_availing_telanagana_disability_pension === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_are_you_availing_telanagana_disability_pension === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Telanagana disability pension\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_are_you_availing_telangana_old_age_pension)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Telangana old age pension\",\n                        scheme: \"Telangana old age pension\",\n                        milestone: \"Pension\",\n                        milestone_category: \"Pension\",\n                        application_submitted: frm.doc.custom_are_you_availing_telangana_old_age_pension === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_are_you_availing_telangana_old_age_pension === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_are_you_availing_telangana_old_age_pension === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Telangana old age pension\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_are_you_availing_telangana_widow_pension)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Telangana widow pension\",\n                        scheme: \"Telangana widow pension\",\n                        milestone: \"Pension\",\n                        milestone_category: \"Pension\",\n                        application_submitted: frm.doc.custom_are_you_availing_telangana_widow_pension === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_are_you_availing_telangana_widow_pension === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_are_you_availing_telangana_widow_pension === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Telangana widow pension\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_are_you_availing_telangana__single_women_pension)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Telangana  single women pension\",\n                        scheme: \"Telangana  single women pension\",\n                        milestone: \"Pension\",\n                        milestone_category: \"Pension\",\n                        application_submitted: frm.doc.custom_are_you_availing_telangana__single_women_pension === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_are_you_availing_telangana__single_women_pension === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_are_you_availing_telangana__single_women_pension === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Telangana  single women pension\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_are_you_availing_pradhan_mantri_mudra_yojana_pmmy)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Pradhan Mantri Mudra Yojana (PMMY)\",\n                        scheme: \"Pradhan Mantri Mudra Yojana (PMMY)\",\n                        milestone: \"Loans\",\n                        milestone_category: \"Loans\",\n                        application_submitted: frm.doc.custom_are_you_availing_pradhan_mantri_mudra_yojana_pmmy === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_are_you_availing_pradhan_mantri_mudra_yojana_pmmy === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_are_you_availing_pradhan_mantri_mudra_yojana_pmmy === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Pradhan Mantri Mudra Yojana (PMMY)\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_are_you_availing_pmegp)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Pradhan mantri Employment Generation Program (PMEGP)\",\n                        scheme: \"Pradhan mantri Employment Generation Program (PMEGP)\",\n                        milestone: \"Livelihood and Skill Development\",\n                        milestone_category: \"Livelihood and Skill Development\",\n                        application_submitted: frm.doc.custom_are_you_availing_pmegp === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_are_you_availing_pmegp === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_are_you_availing_pmegp === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Pradhan mantri Employment Generation Program (PMEGP)\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_are_you_availing_telangana_gas_cylinder_scheme)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Telangana gas cylinder scheme Telangana 500 rupees gas cylinder scheme\",\n                        scheme: \"Telangana gas cylinder scheme Telangana 500 rupees gas cylinder scheme\",\n                        milestone: \"Food Security\",\n                        milestone_category: \"Food Security\",\n                        application_submitted: frm.doc.custom_are_you_availing_telangana_gas_cylinder_scheme === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_are_you_availing_telangana_gas_cylinder_scheme === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_are_you_availing_telangana_gas_cylinder_scheme === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Telangana gas cylinder scheme Telangana 500 rupees gas cylinder scheme\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_are_you_availing_telangana_gruha_jyothi_scheme)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Telangana gruha jyothi scheme\",\n                        scheme: \"Telangana gruha jyothi scheme\",\n                        milestone: \"Electricity\",\n                        milestone_category: \"Electricity\",\n                        application_submitted: frm.doc.custom_are_you_availing_telangana_gruha_jyothi_scheme === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_are_you_availing_telangana_gruha_jyothi_scheme === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_are_you_availing_telangana_gruha_jyothi_scheme === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Telangana gruha jyothi scheme\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n                if([\"No\", \"Yes but required updation\" ,\"Under process\"].includes(frm.doc.custom_5p_are_you_availing_sukanya_samriddhi_yojana)){\n                    let= row ={\n                        name:\"\",\n                        docstatus:'',\n                        name_of_the_scheme: \"Sukanya Samiridhi Yojana\",\n                        scheme: \"Sukanya Samiridhi Yojana\",\n                        milestone: \"Social Security\",\n                        milestone_category: \"Social Security\",\n                        application_submitted: frm.doc.custom_5p_are_you_availing_sukanya_samriddhi_yojana === \"Under process\" ? \"Yes\" : \"No\",\n                        status: frm.doc.custom_5p_are_you_availing_sukanya_samriddhi_yojana === \"Under process\" ? \"Under process\" : \"Open\"\n                    }\n                    if (frm.doc.custom_5p_are_you_availing_sukanya_samriddhi_yojana === \"Under process\") {\n                        row.date_of_application = frappe.datetime.get_today();\n                        row.mode_of_application = \"Offline\";\n                    }\n                let exists = frm.doc.scheme_table.find(r => r.name_of_the_scheme === \"Sukanya Samiridhi Yojana\");\n                !exists&&frm.doc.scheme_table.push(row);\n                }\n                \n      \n            frm.refresh_field('scheme_table');\n        }\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Children Profiling",
  "enabled": 1,
  "modified": "2024-12-04 10:19:00.265572",
  "module": null,
  "name": "Auto add details in child followup table",
  "script": "frappe.ui.form.on('Children Profiling', {\n\trefresh(frm) {\n\t      frm.fields_dict.name_of_the_child_from_beneficiary_profiling.get_query = () => {\n            return {\n              filters: {\n                 completed_age: [\"<\", 26],\n              },\n              page_length: 1000\n            };\n      }\n\t\t// your code here\n\tfrm.fields_dict.slum.get_query = () => {\n            return {\n              filters: {\n                block:frm.doc.slum || `please select cluster`,\n              },\n              page_length: 1000\n            };\n      }\n\t},\n\tbefore_save(frm){\n\t    frm.doc.table_kiit.length && frm.set_value(\"follow_up_status\", frm.doc.table_kiit[frm.doc.table_kiit.length -1].conversion_and_follow_up)\n\n\t},\n\tcluster(frm){\n\t    frm.fields_dict.slum.get_query = () => {\n            return {\n              filters: {\n                block:frm.doc.slum ,\n              },\n              page_length: 1000\n            };\n      }\n\t}\n})\n\nfrappe.ui.form.on('Child Follow Up', {\n\trefresh(frm) {\n\t\t// your code here\n\t},\n\ttable_kiit_add: async function (frm, cdt, cdn) {\n\t    let row = frappe.get_doc(cdt, cdn);\n\t    row.family_phone_number = frm.doc.family_phone_number;\n\t    row.desired_class_enrollment = frm.doc.desired_class_enrollment;\n\t    row.latest_school = frm.doc.latest_school;\n\t    \n\t   // let new_sc = frm.doc.desired_schools.map((e) => {\n    //         return {\n    //             'label':__(e.school_name),\n    //             'value': __(e.school_name)\n\n    //         }\n    //     });\n    //     frm.fields_dict.table_crbf.grid.open_grid_row.fields_dict.school_to_apply_for._data = new_sc;\n\t    refresh_field(\"table_kiit\")\n\t},\n\tform_render: async function (frm, cdt, cdn) {\n\t   // let new_sc = frm.doc.desired_schools.map((e) => {\n    //         return {\n    //             'label':__(e.school_name),\n    //             'value': __(e.school_name)\n    //         }\n    //     });\n        \n    //     frm.fields_dict.table_crbf.grid.open_grid_row.fields_dict.school_to_apply_for._data = new_sc;\n\t    refresh_field(\"table_crbf\")\n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Children Profiling",
  "enabled": 0,
  "modified": "2024-11-21 11:59:44.591176",
  "module": null,
  "name": "Fix Ambiguity",
  "script": "frappe.listview_settings['Children Profiling'] = {\n    onload: function(listview) {\n    }\n};\n",
  "view": "List"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Beneficiary Profiling",
  "enabled": 1,
  "modified": "2025-03-26 15:57:52.952446",
  "module": "myojana",
  "name": "Scheme and Followup Validate",
  "script": "frappe.ui.form.on('Beneficiary Profiling', {\n\tbefore_save(frm) {\n\t\t// your code here\n\t if (frm?.selected_doc?.scheme_table) {\n      for (support_items of frm?.selected_doc?.scheme_table) {\n        if (support_items.application_submitted == \"No\") {\n          if (support_items.status != 'Closed') {\n            support_items.status = 'Open'\n          }\n        } else if (support_items.application_submitted == \"Yes\") {\n          if (support_items.status != 'Closed') {\n            support_items.status = 'Under process'\n          }\n        } else if (support_items.application_submitted == \"Previously availed\") {\n          support_items.status = 'Availed'\n        } else if (support_items.application_submitted == \"Completed\") {\n          support_items.status = 'Completed'\n        }\n      }\n    }\n    // follow up status manage\n    if (frm?.selected_doc?.follow_up_table) {\n      // console.log(\"frm.selected_doc.follow_up_table\", frm.selected_doc.follow_up_table)\n      for (support_item of frm.selected_doc?.scheme_table) {\n        if (!['Completed', 'Previously availed'].includes(support_item.status)) {\n          let followups = frm.selected_doc.follow_up_table.filter(f => f.parent_ref == support_item?.name)\n          let latestFollowup = followups.length ? followups[(followups.length - 1)] : null\n          if (latestFollowup?.parent_ref == support_item.name) {\n            switch (latestFollowup.follow_up_status) {\n              case \"Interested\":\n                support_item.status = \"Open\"\n                support_item.remarks = latestFollowup.remarks || support_item.remarks\n                break;\n              case \"Not interested\":\n                support_item.status = \"Closed\"\n                support_item.remarks = latestFollowup.remarks || support_item.remarks\n                break;\n              case \"Rejected\":\n                support_item.status = \"Rejected\"\n                support_item.date_of_rejection = latestFollowup.date_of_rejection || support_item.date_of_rejection\n                support_item.reason_of_rejection = latestFollowup.reason_of_rejection || support_item.reason_of_rejection\n                support_item.remarks = latestFollowup.remarks || support_item.remarks\n                break;\n              case \"Document submitted\":\n                support_item.application_submitted = \"Yes\"\n                support_item.status = \"Under process\"\n                support_item.date_of_application = latestFollowup.date_of_application || support_item.date_of_application\n                support_item.mode_of_application = latestFollowup.mode_of_application || support_item.mode_of_application\n                support_item.reason_of_application = latestFollowup.reason_of_application || support_item.reason_of_application\n                support_item.application_number = latestFollowup.application_number || support_item.application_number\n                support_item.amount_paid = latestFollowup.amount_paid || support_item.amount_paid\n                support_item.paid_by = latestFollowup.paid_by || support_item.paid_by\n                support_item.remarks = latestFollowup.remarks || support_item.remarks\n                break;\n              case \"Completed\":\n                support_item.status = \"Completed\"\n                support_item.date_of_completion = latestFollowup.date_of_completion || support_item.date_of_completion\n                support_item.completion_certificate = latestFollowup.completion_certificate || support_item.completion_certificate\n                support_item.remarks = latestFollowup.remarks || support_item.remarks\n                break;\n              case \"Not reachable\":\n                if (support_item.status != \"Closed\") {\n                  if (latestFollowup.to_close_status) {\n                    support_item.status = latestFollowup.to_close_status\n                  }\n                  // else {\n                  // support_item.status = support_item?.application_submitted == \"Yes\" ? \"Under process\" : \"Open\"\n                  // }\n                }\n                break;\n              default:\n                support_item.status = \"Under process\"\n                break;\n            }\n          }\n        }\n      }\n\n    }\n\n    let open, under_process, form_submitted, rejected, completed, closed;\n    open = under_process = form_submitted = rejected = completed = closed = 0;\n    let total_no_of_support = 0\n    if (frm.selected_doc.scheme_table) {\n      for (item of frm.selected_doc?.scheme_table) {\n        // global_data.push(item)\n        ++total_no_of_support\n        if (item.status === 'Open') {\n          ++open\n        } else if (item.status === 'Under process') {\n          ++under_process\n        } else if (item.status === 'Form submitted') {\n          ++form_submitted\n        } else if (item.status === 'Rejected') {\n          ++rejected\n        } else if (item.status === 'Completed' || item.status === 'Previously availed') {\n          ++completed\n        } else {\n          ++closed\n        }\n      }\n    }\n    let numberic_overall_status = (completed + rejected) + '/' + (completed + rejected + form_submitted + under_process + open)\n    frm.doc.numeric_overall_status = numberic_overall_status;\n    if (total_no_of_support === open) {\n      frm.doc.overall_status = 'Open'\n    } else if (total_no_of_support === completed) {\n      frm.doc.overall_status = 'Completed'\n    } else {\n      if (total_no_of_support === open + under_process + form_submitted) {\n        frm.doc.overall_status = 'Open'\n      } else if (total_no_of_support === completed + closed + rejected) {\n        frm.doc.overall_status = 'Completed'\n      } else {\n        frm.doc.overall_status = 'Partially completed'\n      }\n    }\n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Beneficiary Profiling",
  "enabled": 1,
  "modified": "2025-03-26 16:10:34.184600",
  "module": "Mari",
  "name": "Update Follow Up",
  "script": "frappe.ui.form.on('Beneficiary Profiling', {\n\tbefore_save(frm) {\n\t\t\n    // 20 Mar 2025 new changes\n    let existing_follow_up = frm.doc.follow_up_table.map(e => e.name_of_the_scheme);\n    // let new_scheme = frm.doc.scheme_table.filter(e => e.__islocal);\n\n    let new_scheme = frm.doc.scheme_table.filter(e => !existing_follow_up.includes(e.name_of_the_scheme));\n\n    for (let i = 0; i < new_scheme.length; i++) {\n      if (!existing_follow_up.includes(new_scheme[i].name_of_the_scheme)) {\n        if (['No','Yes','Previously availed'].includes(new_scheme[i].application_submitted)) {\n          frm.add_child('follow_up_table', {\n            name_of_the_scheme: new_scheme[i].name_of_the_scheme,\n            follow_up_date: new Date(),\n            follow_up_with: 'Beneficiary',\n            follow_up_mode: 'Home visit',\n            follow_up_status: new_scheme[i].application_submitted=='No'?'Interested':new_scheme[i].application_submitted=='Previously availed'?'Not interested':'Under process',\n            remarks: new_scheme[i].remarks ?? 'System Generated'\n          });\n        } else if (new_scheme[i].application_submitted == 'Completed') {\n          frm.add_child('follow_up_table', {\n            name_of_the_scheme: new_scheme[i].name_of_the_scheme,\n            follow_up_date: new Date(),\n            follow_up_with: 'Beneficiary',\n            follow_up_mode: 'Home visit',\n            follow_up_status: 'Completed',\n            date_of_completion:new_scheme[i].date_of_completion,\n            completion_certificate: new_scheme[i].completion_certificate,\n            remarks: new_scheme[i].remarks ? new_scheme[i].remarks+'-'+'(System Generated)' : 'System Generated'\n          });\n        }\n      }\n    }\n    frm.refresh_field('follow_up_table');\n    // 20 Mar 2025 new changes\n\t}\n})",
  "view": "Form"
 }
]